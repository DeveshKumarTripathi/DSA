class Solution {
    public List<Integer> spiralOrder(int[][] mat) {
        ArrayList<Integer> res = new ArrayList<>();
        
        int m = mat.length, n = mat[0].length;
        int srow = 0, erow = m-1, scol = 0, ecol = n-1;
        
        while(srow <= erow && scol <= ecol){
            for(int i = scol; i <= ecol; i++){
                res.add(mat[srow][i]);
            }
            for(int i = srow+1; i <= erow; i++){
                res.add(mat[i][ecol]);
            }
            for(int i = ecol-1; i >= scol; i--){
                if(srow == erow)break;
                res.add(mat[erow][i]);
            }
            for(int i = erow-1; i > srow; i--){
                if(scol == ecol)break;
                res.add(mat[i][scol]);
            }
            srow++; erow--; scol++; ecol--;
        }return res;
    }
}
